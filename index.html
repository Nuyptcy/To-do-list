<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.4/themes/cupertino/jquery-ui.css">
    <title>To-do-list</title>
    <style>
    body{
      background-color: rgb(227, 233, 255);
    }
    #card{
    margin: 10%;
    }
    .navbar-color{
      background-color: rgb(175,127, 232);
      color: white;
    }
    </style>
</head>
<body>
  <div id="card">
      <nav class="navbar navbar-expand-lg navbar-color">
          <button class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse" > <!-- diff : 先寫 button 再寫 a.navbar-brand -->
            <span class="navbar-toggler-icon"></span>
          </button>
          <a class="navbar-brand" href="#">ＭＭ：</a>
              
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav">
              <li class="nav-item active"><a href="#" class="nav-link">MyMoney</a></li>
              <li class="nav-item"><a href="#" class="nav-link"><i class="fa fa-clock"></i></a></li>
              <li class="nav-item"><a href="#" class="nav-link">C</a></li>
            </ul>
          </div>
      </nav>
      <div class="container">
          <div class="row">
              <div class="form-group col-md-6">
                <label for="formGroupExampleInput">日期</label>
                <input type="text" class="form-control" id="">
              </div>
                <button type="button" class="btn btn-info"  text-align="center" >Button</button>
          </div>
         
      </div>
  </div>
  <input id="txt" type="text" placeholder="請輸入行程">
  <input type="button" id="send" value="送出">
  <!-- 將資料寫進ul列表 -->
  <ul id="list"></ul>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.14.2/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.9.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.9.3/firebase-database.js"></script>
<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyBL26Gq3VAoQaZXQHHPv2vUlvGc5Zyty1I",
    authDomain: "to-do-list-5b197.firebaseapp.com",
    databaseURL: "https://to-do-list-5b197.firebaseio.com",
    projectId: "to-do-list-5b197",
    storageBucket: "to-do-list-5b197.appspot.com",
    messagingSenderId: "992218011327",
    appId: "1:992218011327:web:45bc9309ec139db106180a",
    measurementId: "G-Y0GZKYNTDM"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  //firebase.analytics();

  var database =firebase.database();
  console.log(database);

  //dom
  var txt = document.getElementById('txt');
  var send = document.getElementById('send');
  var list = document.getElementById('list');

  //todos connect to Firebase
  //按送出按鈕，寫進DB
  var todos = firebase.database().ref('todos');

  //顯示內容
  send.addEventListener('click',function(e){
    console.log(txt.value);
    todos.push({content: txt.value})
  })


  //即時顯示內容
  todos.on('value',function(snapshot){
    //累加html
    var str = '';
    //撈回資料
    //js可讀取的物件格式
    var data  = snapshot.val();
    for(var item in data){
      str+='<li data-key="'+ item +'">'+data[item].content+'</li>';
      console.log(item);

  }
  //把撈到的值帶回str裡
  list.innerHTML = str;
})

//刪除
list.addEventListener('click',function(e){
  if(e.target.nodeName="LI"){
    //用dataset讀取data-key的物件
    var key = e.target.dataset.key;
    todos.child(key).remove();
  }
})

</script>
</body>
</html>